### **Part 1: Introduction & Lesson Objectives**

1.  This module covers the network, infrastructure, and VM cluster supporting the Exadata Database Service.
2.  The service can run on dedicated Exadata Cloud Infrastructure in the **Oracle Public Cloud** or on **Exadata Cloud@Customer** in a customer's data center.
3.  **Lesson Objectives:** After completing this lesson, you should be able to:
    *   Describe the network architecture of the Exadata Database Service.
    *   Describe and create the **Exadata Infrastructure** resource in the public cloud.
    *   Describe and create the **Exadata VM Cluster** resource.
    *   Describe the storage configuration options for the VM cluster.

### **Part 2: Network Architecture Overview**

4.  The architecture involves specific networking elements for both public cloud and Cloud@Customer deployments.
5.  **Key Components on the Exadata Rack:**
    *   **Compute Servers:** Virtualized with `dom0` for Oracle-managed components and `DomU` for customer-managed components (where your database VMs run).
    *   **Client Network (2x25 Gbps):** For customer application access to databases via SCAN and Virtual IPs (VIPs). Requires **2 IPs per compute server, 3 SCAN IPs, and 3 reserve IPs**.
    *   **Backup Network (2x25 Gbps):** For backup traffic and bulk transfers, separate from client traffic. Requires **1 IP per compute server and 3 reserve IPs**.
    *   **Cloud Operations Network (1 Gbps):** A dedicated, Oracle-only network for infrastructure management. **Customer access is not permitted.**
    *   **RoCE (RDMA over Converged Ethernet) Fabric:** A high-speed, low-latency internal network connecting all database and storage servers for RAC interconnect and storage access.

### **Part 3: Prerequisite: OCI Virtual Cloud Network (VCN) Setup**

6.  Before provisioning the Exadata service, you must configure a **Virtual Cloud Network (VCN)** in the same target region.
7.  A VCN is a virtual private network with firewall rules and gateways.
8.  **VCN Planning is Critical:**
    *   Resides in a single region and covers a contiguous IPv4 CIDR block (size from /16 to /30).
    *   The size **cannot be changed after creation**.
    *   Recommended to use RFC 1918 private IP ranges.
9.  **Required Subnets:** Two subnets are needed within the VCN:
    *   A **Client Subnet**
    *   A **Backup Subnet**
    *   **Regional subnets** (spanning all Availability Domains) are recommended.
10. **Network Gateways:** Configure as needed for connectivity:
    *   **Dynamic Routing Gateway (DRG):** For connection to on-premise networks via VPN or FastConnect.
    *   **NAT Gateway:** For outbound-only internet access from private subnets.
    *   **Internet Gateway:** For direct internet connectivity (if using public subnets).
    *   **Service Gateway:** For private access to Oracle services like Object Storage.
11. **Management Access:** Cloud tenancy admins can manage the service via the **OCI Console, CLI, or REST APIs** over HTTPS.

### **Part 4: Exadata Database Service Architecture & Resource Model**

12. **Physical Infrastructure:** Comprises a minimum of **2 Database Servers** and **3 Storage Servers** connected via the RoCE fabric. This provides High Availability (HA) and allows ASM to be provisioned in **high redundancy (triple-mirroring)** mode.
13. **Scalability:** The service can be scaled vertically (adding cores) and horizontally (adding servers) online.
14. **Logical Hierarchy:**
    *   **Exadata Cloud Infrastructure:** The physical foundation.
    *   **VM Cluster:** Resides on the infrastructure, containing Oracle Clusterware/Grid Infrastructure.
    *   **Virtual Machines (VMs):** Run on the physical database servers within the cluster.
    *   **Database Homes & Databases:** Reside on the VMs; a home can contain one or more RAC databases.
15. **Responsibility Split:**
    *   **Oracle Manages:** The physical infrastructure (servers, storage, fabric) and its maintenance.
    *   **Customer Manages:** Everything inside the database VMs (database software, data, schema, keys).
16. **Supported Versions:** Oracle Database 12c R1 and 19c.
17. **Multi-VM Clusters:** A single Exadata Infrastructure (both public cloud and Cloud@Customer) can support **multiple VM clusters**.

### **Part 5: Provisioning Resources & IAM**

18. Provisioning requires creating two main resources in sequence:
    1.  **Cloud Exadata Infrastructure Resource:** Manages the physical infrastructure, maintenance scheduling, and expansion.
    2.  **Cloud VM Cluster Resource:** Manages networking, software, databases, and scaling of OCPUs.
19. **IAM Policies:** Users must be granted the appropriate Identity and Access Management (IAM) policies to create and manage these resources.

### **Part 6: Demo - Creating Exadata Infrastructure in the Public Cloud**

20. **Navigation:** Console > Oracle Database > Exadata on Oracle Public Cloud > Exadata Infrastructure > Create Exadata Infrastructure.
21. **Basic Configuration:**
    *   Select the **Compartment**.
    *   Enter a **Display Name** (does not need to be unique; an OCID is assigned).
    *   Choose the **Availability Domain**.
22. **System Model Selection:**
    *   **Fixed Shape Systems (X6, X7, X8):** Choose quarter, half, or full rack.
    *   **Elastic Shape Systems (X8M, X9M+):** Elastically choose the number of compute and storage servers (default is 2 compute, 3 storage).
    *   **Exadata Base Model:** An economical quarter-rack-like configuration with fixed, lower capacity.
23. **Maintenance Window Configuration (Optional but Recommended):**
    *   Can specify a schedule for automatic infrastructure maintenance.
    *   Configure **Month, Week of Month, Day of Week, Start Hour, and Notification Lead Time**.
    *   If unspecified, Oracle chooses a low-disruption time.
24. **Creation:** Click **Create Exadata Infrastructure**. The status will show **"Provisioning"** (redwood icon) and then turn **green** upon success. A **red** icon indicates failure.

### **Part 7: Storage Configuration for the VM Cluster**

25. Storage is configured using Oracle Automatic Storage Management (ASM). Default disk groups are created:
    *   **DATA\_\<identifier>:** For database data files.
    *   **RECO\_\<identifier>:** For the Fast Recovery Area (FRA - backups, archive logs).
26. **Key Pre-Provisioning Decisions (Cannot be changed later):**
    *   **Allocate Storage for Exadata Sparse Snapshots:**
        *   **Yes:** Creates a **SPARSE** disk group, enabling fast, space-efficient database cloning for Dev/Test. Allocates less space to DATA and RECO.
        *   **No:** No SPARSE disk group is created; snapshot functionality is unavailable. More space is allocated to DATA.
    *   **Allocate Storage for Local Backups:**
        *   **Yes:** Allocates more space to the **RECO** disk group to accommodate backups on local Exadata storage.
        *   **No:** Allocates more space to the **DATA** disk group. You cannot use local Exadata storage for backups.
27. **Exadata Sparse Snapshots Explained:**
    *   Ideal for creating quick, space-efficient clones from a **test master** (a full clone of a source database).
    *   Snapshots consume storage only for changed blocks, reading unchanged blocks from the test master.
    *   Supports **hierarchical snapshots** (snapshots of snapshots), with a recommended depth of 10 or less.
    *   Sparse test masters can be updated via Data Guard, allowing multiple snapshot points in time from one full copy.

### **Part 8: Demo - Creating the Exadata VM Cluster in the Public Cloud**

28. **Prerequisites:** Exadata Infrastructure must be created, and required subnets (client, backup) must exist in your VCN. Private DNS views/zones should be set up if needed.
29. **Navigation:** Console > Oracle Database > Exadata on Oracle Public Cloud > Create VM Cluster.
30. **Basic Configuration:**
    *   Select the **Compartment** (can be different from the infrastructure's compartment).
    *   Enter a **Display Name** and optional cluster name.
    *   Select the **Exadata Infrastructure**.
    *   Choose the **Grid Infrastructure (GI) Version** (dictates the maximum supported database version).
31. **VM Cluster Resource Allocation:**
    *   Specify **OCPUs per VM**, **Memory per VM** (min 30 GB), and **Local Storage per VM** (min 60 GB).
    *   Click **Change DB Servers** to select a minimum of **two database servers** for VM placement.
    *   Specify the total **Usable Exadata Storage** (min 2 TB).
32. **Storage Configuration:** Select the options for **Sparse Snapshots** and **Local Backups** as per your business needs.
33. **SSH Keys:** Add a public SSH key for secure access to the VMs (Generate, Upload, or Paste).
34. **Network Settings:**
    *   Select the **VCN**, **Client Subnet**, and **Backup Subnet**.
    *   Option to use **Network Security Groups (NSGs)** now or later.
    *   Option to use **Private DNS** (provide private view and zone).
    *   Set a **Hostname Prefix** for the VMs.
35. **License Type:** Choose **Bring Your Own License (BYOL)** or **License Included**.
36. **Advanced Options:** Configure **Time Zone**, non-default **SCAN Port** (default 1521), and **Tags**.
37. **Creation:** Click **Create VM Cluster**. Status is **"Provisioning"** and then **"Available"** (green icon). The VM Cluster Details page shows resource allocations and allows you to view the list of provisioned VMs and their IP addresses.

### **Part 9: Lesson Summary**

38. This lesson covered how to:
    *   Describe the Exadata Database Service network architecture.
    *   Describe and create the **Exadata Infrastructure** resource.
    *   Describe and create the **Exadata VM Cluster** resource.
    *   Understand the critical **storage configuration options** for the VM cluster.
